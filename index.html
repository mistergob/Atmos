<!DOCTYPE html>
<html>
<head>
    <title>Interactions avec des cercles</title>
    <style>
        /* Vos styles CSS ici */
        .dropdown-menu {
            position: absolute;
            border: 1px solid #ddd;
            background: #f9f9f9;
            padding: 10px;
        }

        .dropdown-item {
            display: block;
            margin: 5px 0;
            cursor: pointer;
        }

        circle {
            fill: white;
            stroke: black;
            stroke-width: 2px;
        }

        line {
            stroke: black;
            stroke-width: 2px;
        }
    </style>
</head>
<body>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script>
        var width = window.innerWidth,
            height = window.innerHeight;

        var svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height);

        var nodes = [
            {id: 1, x: 200, y: 200, name: "Cercle 1", url: "#"},
            // Ajoutez d'autres nœuds initiaux ici si nécessaire
        ];

        var lines = svg.selectAll("line");
        var menu;

        dessinerCercles();

        function dessinerCercles() {
            svg.selectAll("g").remove();

            const group = svg.selectAll("g")
                .data(nodes)
                .enter().append("g")
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));

            group.append("circle")
                .attr("r", 50)
                .attr("cx", d => d.x)
                .attr("cy", d => d.y)
                .on("contextmenu", ouvrirMenuContextuel);

            group.append("text")
                .attr("x", d => d.x)
                .attr("y", d => d.y)
                .attr("dy", ".35em")
                .text(d => d.name)
                .style("text-anchor", "middle");

            updateLines();
        }

        // ... Autres fonctions (dragstarted, dragged, dragended, renommerCercle, ajouterCercle, ouvrirURL, ouvrirMenuContextuel)

        function updateLines() {
            var lineData = [];

            nodes.forEach(function(node1, index1) {
                nodes.forEach(function(node2, index2) {
                    if (index1 != index2) {
                        var distance = Math.sqrt(Math.pow(node1.x - node2.x, 2) + Math.pow(node1.y - node2.y, 2));
                        if (distance < 200) { // 200 car le rayon de chaque cercle est de 50
                            lineData.push({"x1": node1.x, "y1": node1.y, "x2": node2.x, "y2": node2.y});
                        }
                    }
                });
            });

            lines = svg.selectAll("line").data(lineData);

            lines.enter().append("line")
                .attr("x1", d => d.x1)
                .attr("y1", d => d.y1)
                .attr("x2", d => d.x2)
                .attr("y2", d => d.y2);

            lines.exit().remove();
        }
    </script>
</body>
</html>
