<!DOCTYPE html>
<html>
<head>
    <title>Interactions avec des cercles</title>
    <style>
        /* Ajoutez vos styles CSS ici */
        .dropdown-menu {
            position: absolute;
            border: 1px solid #ddd;
            background: #f9f9f9;
            padding: 10px;
        }

        .dropdown-item {
            display: block;
            margin: 5px 0;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script>
var width = window.innerWidth,
    height = window.innerHeight;

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

var nodes = [
    {id: 1, x: 200, y: 200, name: "Cercle 1"},
    {id: 2, x: 300, y: 200, name: "Cercle 2"}
    // Ajoutez d'autres n≈ìuds ici
];

dessinerCercles();

var lines = svg.selectAll("line");

function dessinerCercles() {
    svg.selectAll("circle").remove();

    var group = svg.selectAll("g")
        .data(nodes)
        .enter().append("g")
        .call(d3.drag()
            .on("start", dragstarted)
            .on("drag", dragged)
            .on("end", dragended));

    group.append("circle")
        .attr("r", 50)
        .attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; })
        .on("contextmenu", ouvrirMenuContextuel);

    group.append("text")
        .attr("x", function(d) { return d.x; })
        .attr("y", function(d) { return d.y; })
        .attr("dy", ".35em")
        .text(function(d) { return d.name; })
        .style("text-anchor", "middle");
}

function dragstarted(d) {
    d3.event.sourceEvent.stopPropagation();
}

function dragged(d) {
    d.x = d3.event.x;
    d.y = d3.event.y;
    d3.select(this).select("circle").attr("cx", d.x).attr("cy", d.y);
    d3.select(this).select("text").attr("x", d.x).attr("y", d.y);
    updateLines();
}

function dragended(d) {
    updateLines();
}

// ... Reste du code (updateLines, ouvrirMenuContextuel)

function renommerCercle(d) {
    var nouveauNom = prompt("Entrez le nouveau nom du cercle:", d.name);
    if (nouveauNom != null) {
        d.name = nouveauNom;
        dessinerCercles();
    }
}

// Modification de la section de renommage du cercle dans ouvrirMenuContextuel
// ...
menu.append("a")
    .attr("class", "dropdown-item")
    .text("Renommer le cercle")
    .on("click", function() {
        d3.event.preventDefault();
        renommerCercle(d);
        menu.remove();
    });
        function updateLines() {
    var lineData = [];

    nodes.forEach(function(node1, index1) {
        nodes.forEach(function(node2, index2) {
            if (index1 != index2 && Math.abs(node1.x - node2.x) < 100 && Math.abs(node1.y - node2.y) < 100) {
                lineData.push({"x1": node1.x, "y1": node1.y, "x2": node2.x, "y2": node2.y});
            }
        });
    });

    lines = lines.data(lineData, function(d) { return d.x1 + "-" + d.y1 + "-" + d.x2 + "-" + d.y2; });

    lines.enter().append("line")
        .attr("x1", function(d) { return d.x1; })
        .attr("y1", function(d) { return d.y1; })
        .attr("x2", function(d) { return d.x2; })
        .attr("y2", function(d) { return d.y2; });

    lines.exit().remove();
}

function ouvrirMenuContextuel(d) {
    d3.event.preventDefault();

    var top = d3.event.pageY - 10;
    var left = d3.event.pageX - 10;

    var menu = d3.select("body")
        .append("div")
        .attr("class", "dropdown-menu")
        .style("top", top + "px")
        .style("left", left + "px");

    // ... Autres options du menu ici

    d3.select("body").on("click", function() {
        menu.remove();
    });
}
    </script>
</body>
</html>
